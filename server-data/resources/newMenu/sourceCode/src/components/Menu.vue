<template lang="pug">
  .menu__wrapper
    .menu(:id='menu.id')
      a.menu__item(v-for='item in menu.items', :href='item.url')
        svg.menu__item-icon(:width="item.img.width" :height="item.img.height" :viewbox="item.img.viewbox" xmlns="http://www.w3.org/2000/svg")
          path(v-for='path in item.img.path'  :d="path")
    .menu__submenu#personal
      a.menu__submenu-item(href='#passport') Паспорт
      a.menu__submenu-item(href='#') Лицензии
      a.menu__submenu-item(href='#') Собственность
    .menu__list
      .menu__list-head
        p.menu__list-header Паспорт
      .menu__list-body#passport
        a.menu__list-item(href='#open') Что-то
        a.menu__list-item(href='#') Что-то
      .menu__list-controls#open
        a.menu__list-controls-item(href='#') Открыть
        a.menu__list-controls-item(href='#') Закрыть
        a.menu__list-controls-item(href='#') Перекрыть
    //- menu-list(ref='list')
</template>

<script>
// import MenuList from "./menu-list";

export default {
  name: "Menu",
  components: {
    // MenuList
  },
  data() {
    return {
      menu: {
        id: "menu",
        items: [
          {
            url: "#documents",
            img: {
              width: 20,
              height: 20,
              viewbox: "0 0 20 20",
              path: [
                "M10 10C7.25 10 5 7.75 5 5C5 2.25 7.25 0 10 0C12.75 0 15 2.25 15 5C15 7.75 12.75 10 10 10ZM10 12.5C13.375 12.5 20 14.125 20 17.5V20H0V17.5C0 14.125 6.625 12.5 10 12.5Z"
              ]
            }
          },
          {
            url: "#animations",
            img: {
              width: 22,
              height: 22,
              viewbox: "0 0 22 22",
              path: [
                "M2.75 1.83331H0.916667C0.366667 1.83331 0 2.19998 0 2.74998V4.58331C0 5.13331 0.366667 5.49998 0.916667 5.49998H2.75C3.3 5.49998 3.66667 5.13331 3.66667 4.58331V2.74998C3.66667 2.19998 3.3 1.83331 2.75 1.83331Z",
                "M2.75 9.16663H0.916667C0.366667 9.16663 0 9.53329 0 10.0833V11.9166C0 12.4666 0.366667 12.8333 0.916667 12.8333H2.75C3.3 12.8333 3.66667 12.4666 3.66667 11.9166V10.0833C3.66667 9.53329 3.3 9.16663 2.75 9.16663Z",
                "M2.75 16.5H0.916667C0.366667 16.5 0 16.8667 0 17.4167V19.25C0 19.8 0.366667 20.1667 0.916667 20.1667H2.75C3.3 20.1667 3.66667 19.8 3.66667 19.25V17.4167C3.66667 16.8667 3.3 16.5 2.75 16.5Z",
                "M21.0835 1.83331H8.25016C7.70016 1.83331 7.3335 2.19998 7.3335 2.74998V4.58331C7.3335 5.13331 7.70016 5.49998 8.25016 5.49998H21.0835C21.6335 5.49998 22.0002 5.13331 22.0002 4.58331V2.74998C22.0002 2.19998 21.6335 1.83331 21.0835 1.83331Z",
                "M21.0835 9.16663H8.25016C7.70016 9.16663 7.3335 9.53329 7.3335 10.0833V11.9166C7.3335 12.4666 7.70016 12.8333 8.25016 12.8333H21.0835C21.6335 12.8333 22.0002 12.4666 22.0002 11.9166V10.0833C22.0002 9.53329 21.6335 9.16663 21.0835 9.16663Z",
                "M21.0835 16.5H8.25016C7.70016 16.5 7.3335 16.8667 7.3335 17.4167V19.25C7.3335 19.8 7.70016 20.1667 8.25016 20.1667H21.0835C21.6335 20.1667 22.0002 19.8 22.0002 19.25V17.4167C22.0002 16.8667 21.6335 16.5 21.0835 16.5Z"
              ]
            }
          },
          {
            url: "#inventory",
            img: {
              width: 26,
              height: 26,
              viewbox: "0 0 26 26",
              path: [
                "M6.68144 18.4283H19.3188V22.0389H6.68144V18.4283ZM23.1153 2.81422L21.6772 8.73913C22.2346 9.94847 22.5491 11.2918 22.5516 12.7074L22.5705 23.6429C22.5716 24.2646 22.3304 24.8497 21.8916 25.2902C21.4526 25.7307 20.8684 25.9739 20.2466 25.9749L5.78076 26C5.78037 26 5.77712 26 5.77673 26C4.49545 26 3.45103 24.9574 3.44869 23.6761L3.42986 12.7406C3.42739 11.3216 3.73307 9.94977 4.31353 8.69991L2.88486 2.81422C2.81058 2.50802 2.95186 2.19001 3.22897 2.0399L5.61844 0.745369C5.8079 0.642653 6.03424 0.633953 6.2311 0.721346C6.42796 0.808868 6.57314 0.982744 6.62404 1.1922L7.51991 4.8832C7.94648 4.58428 8.39513 4.3234 8.86067 4.09966V3.61062C8.86054 1.61968 10.4802 0 12.4712 0H13.529C15.5199 0 17.1396 1.61968 17.1396 3.61062V4.11589C17.6069 4.34262 18.0542 4.60493 18.4757 4.90151L19.376 1.1922C19.4269 0.982744 19.5719 0.808868 19.7689 0.721346C19.9658 0.633823 20.192 0.642653 20.3815 0.745369L22.771 2.0399C23.0483 2.19014 23.1895 2.50802 23.1153 2.81422ZM10.2517 3.56219C11.1239 3.30196 12.0382 3.1647 12.9741 3.16314H12.9911C13.9498 3.16314 14.8753 3.30728 15.7491 3.57206C15.7282 2.36479 14.7412 1.3888 13.5291 1.3888H12.4713C11.2623 1.38867 10.2778 2.35947 10.2517 3.56219ZM20.7075 17.7339C20.7075 17.3505 20.3966 17.0396 20.0131 17.0396H5.9871C5.60364 17.0396 5.29276 17.3505 5.29276 17.7339V22.7334C5.29276 23.1168 5.60364 23.4277 5.9871 23.4277H20.0131C20.3966 23.4277 20.7075 23.1168 20.7075 22.7334V17.7339ZM20.7075 13.059C20.7075 8.80912 17.25 5.35159 13.0001 5.35159C8.75016 5.35159 5.29263 8.80912 5.29263 13.059C5.29263 13.4425 5.60351 13.7534 5.98697 13.7534C6.37043 13.7534 6.68131 13.4425 6.68131 13.059C6.68131 9.57487 9.51579 6.74039 12.9999 6.74039C16.4841 6.74039 19.3186 9.57487 19.3186 13.059C19.3186 13.4425 19.6294 13.7534 20.0129 13.7534C20.3964 13.7534 20.7075 13.4425 20.7075 13.059Z"
              ]
            }
          },
          {
            url: "#acessories",
            img: {
              width: 26,
              height: 26,
              viewbox: "0 0 26 26",
              path: [
                "M18.9435 2.66724L18.6184 2.99302V2.66724H17.0167C16.2945 3.7832 14.7698 4.55459 12.9997 4.55459C11.2302 4.55459 9.70559 3.7832 8.98342 2.66724H7.3817V2.99302L7.05592 2.66724L1.29541 8.43098L4.44639 11.5846L7.3817 8.64795V23.3323H18.6171V8.6486L21.553 11.5852L24.7034 8.43098L18.9435 2.66724Z",
                "M18.6172 24.6276H7.38182C6.66678 24.6276 6.08645 24.0473 6.08645 23.3322V11.7762L5.36234 12.5003C5.11946 12.7439 4.78979 12.8799 4.44587 12.8799C4.10259 12.8799 3.77227 12.7432 3.52939 12.5003L0.378407 9.34677C-0.126787 8.84092 -0.126787 8.0216 0.378407 7.51511L6.14021 1.75137C6.4213 1.46963 6.8274 1.33297 7.2186 1.38219C7.27236 1.37571 7.32677 1.37183 7.38182 1.37183H8.98354C9.42268 1.37183 9.83266 1.59463 10.071 1.96316C10.5807 2.75075 11.7304 3.25918 12.9998 3.25918C14.2693 3.25918 15.4196 2.75075 15.9293 1.96316C16.1677 1.59463 16.577 1.37183 17.0168 1.37183H18.6185C18.6736 1.37183 18.728 1.37506 18.7817 1.38219C18.8348 1.37571 18.8886 1.37183 18.943 1.37183C18.9436 1.37183 18.9436 1.37183 18.9436 1.37183C19.2869 1.37183 19.6166 1.50849 19.8601 1.75137L25.6206 7.51447C26.1258 8.02031 26.1258 8.83963 25.6206 9.34612L22.4703 12.5003C22.2274 12.7432 21.8977 12.8799 21.5545 12.8799C21.5538 12.8799 21.5538 12.8799 21.5538 12.8799C21.2105 12.8805 20.8809 12.7439 20.638 12.501L19.9132 11.7756V23.3322C19.9126 24.0479 19.3329 24.6276 18.6172 24.6276ZM8.67719 22.0368H17.3218V8.64856C17.3218 8.12459 17.6373 7.65242 18.1211 7.45164C18.6055 7.25021 19.1619 7.36161 19.533 7.73274L21.5525 9.75222L22.8725 8.43094L18.728 4.28382C18.5213 4.3026 18.318 4.27021 18.123 4.1899C17.9877 4.1342 17.8652 4.05648 17.759 3.96256H17.6476C16.5783 5.14135 14.8645 5.84992 12.9998 5.84992C11.1352 5.84992 9.42203 5.14135 8.35205 3.96256H8.24065C8.13508 4.05648 8.01267 4.13355 7.8773 4.1899C7.68105 4.27086 7.4725 4.29936 7.27107 4.28382L3.12589 8.43159L4.44587 9.75286L6.4647 7.73274C6.83518 7.36161 7.39218 7.25086 7.87665 7.45164C8.36112 7.65242 8.67654 8.12459 8.67654 8.64856V22.0368H8.67719Z"
              ]
            }
          },
          {
            url: "#actions",
            img: {
              width: 24,
              height: 24,
              viewbox: "0 0 24 24",
              path: [
                "M19.9067 14.1339H14.1092V16.0321H9.89076V14.1339H4.09329C2.46925 14.1339 1.00761 13.4261 0 12.303V22.8457H24V12.303C22.9924 13.4261 21.5308 14.1339 19.9067 14.1339Z",
                "M4.09329 12.7278H9.89076V10.8762H14.1092V12.7278H19.9067C22.162 12.7278 23.997 10.8945 24 8.63989V6.00269C24 5.45041 23.5523 5.00269 23 5.00269H17.3483V4.5099C17.3483 2.65962 15.843 1.1543 13.9927 1.1543H10.0074C8.15709 1.1543 6.65177 2.65962 6.65177 4.5099V5.00264H0.999999C0.447714 5.00264 0 5.45036 0 6.00264V8.64167C0.00393707 10.8955 1.83861 12.7278 4.09329 12.7278ZM8.05782 4.5099C8.05782 3.43494 8.93237 2.56039 10.0073 2.56039H13.9926C15.0676 2.56039 15.9421 3.43494 15.9421 4.5099V5.00264H8.05782V4.5099Z",
                "M12.7032 12.2822H11.2969V14.626H12.7032V12.2822Z"
              ]
            }
          },
          {
            url: "#6",
            img: {
              width: 28,
              height: 28,
              viewbox: "0 0 28 28",
              path: [
                "M0.60638 9.85226H2.65994C2.81635 9.85226 2.96666 9.9127 3.07956 10.0209L3.51792 10.4408C4.25685 8.73106 5.31689 7.04032 6.7487 5.28992C7.52271 4.34413 8.66725 3.80176 9.88922 3.80176H18.1108C19.3329 3.80176 20.4775 4.3442 21.2511 5.28998C22.7281 7.09544 23.7671 8.74546 24.4885 10.4348L24.9204 10.0209C25.0333 9.9127 25.1837 9.85226 25.3401 9.85226H27.3935C27.7285 9.85226 28 10.1238 28 10.4588V11.8628C28 12.1829 27.7511 12.4478 27.4316 12.468L25.3209 12.601C25.6398 13.5329 25.8889 14.9216 25.8889 16.88C25.8889 18.5793 25.5495 19.6962 24.9588 20.4192V23.6906C24.9588 23.9712 24.7313 24.1985 24.4508 24.1985H22.1145C21.8338 24.1985 21.6063 23.9712 21.6063 23.6906V21.6591H6.39361V23.6906C6.39361 23.9712 6.16612 24.1985 5.8856 24.1985H3.54924C3.26872 24.1985 3.04123 23.9712 3.04123 23.6906V20.4192C2.45068 19.6962 2.11108 18.5793 2.11108 16.88C2.11108 14.9216 2.36009 13.5329 2.679 12.601L0.568316 12.468C0.248882 12.4478 0 12.1829 0 11.8628V10.4588C0 10.1238 0.271383 9.85226 0.60638 9.85226ZM19.5177 6.70798C19.171 6.28428 18.6582 6.04117 18.1108 6.04117H9.88922C9.34185 6.04117 8.82885 6.28428 8.48224 6.70798C7.48056 7.93248 6.6895 9.10432 6.07812 10.2716L21.9359 10.2746C21.3379 9.13324 20.5423 7.96043 19.5177 6.70798ZM21.2458 19.1748C22.4087 19.1748 23.3513 18.795 23.3513 17.8736C23.3513 16.9522 23.0093 16.2051 21.8465 16.2051C20.6836 16.2051 19.1404 16.9522 19.1404 17.8736C19.1404 18.7949 20.0831 19.1748 21.2458 19.1748ZM11.7929 18.9828H16.207C16.8724 18.9828 17.4137 18.4414 17.4137 17.776C17.4137 17.5894 17.2624 17.4381 17.0756 17.4381H10.9241C10.7374 17.4381 10.5862 17.5894 10.5862 17.776C10.5862 18.4415 11.1275 18.9828 11.7929 18.9828ZM6.75415 19.1748C7.91698 19.1748 8.85965 18.795 8.85965 17.8736C8.85965 16.9522 7.31624 16.2051 6.15361 16.2051C4.99078 16.2051 4.64871 16.9522 4.64871 17.8736C4.64871 18.7949 5.59126 19.1748 6.75415 19.1748Z"
              ]
            }
          },
          {
            url: "#7",
            img: {
              width: 26,
              height: 26,
              viewbox: "0 0 26 26",
              path: [
                "M3.64666 12.2462L1.69189 14.2009L11.7987 24.3077L13.7535 22.353L3.64666 12.2462Z",
                "M2.13931 16.7693L0.21968 18.6889C-0.0732266 18.9818 -0.0732266 19.4567 0.21968 19.7496L6.25041 25.7803C6.39686 25.9268 6.58882 26 6.78072 26C6.97262 26 7.16462 25.9267 7.31103 25.7803L9.23071 23.8606L2.13931 16.7693Z",
                "M14.2009 1.6927L12.2461 3.64746L22.3526 13.7539L24.3073 11.7992L14.2009 1.6927Z",
                "M25.7802 6.25037L19.7494 0.219642C19.4565 -0.0732139 18.9816 -0.0732139 18.6887 0.219642L16.769 2.13933L23.8604 9.23072L25.7801 7.31104C26.0731 7.01813 26.0731 6.54323 25.7802 6.25037Z",
                "M14.2003 7.72327L7.72266 14.2009L11.7987 18.277L18.2763 11.7993L14.2003 7.72327Z"
              ]
            }
          },
          {
            url: "#8",
            img: {
              width: 21,
              height: 21,
              viewbox: "0 0 21 21",
              path: [
                "M0.0657578 9.33409C0.0989647 9.03889 0.44315 8.81707 0.740767 8.81707C1.703 8.81707 2.55686 8.25207 2.91496 7.37829C3.28079 6.48333 3.0449 5.4396 2.32777 4.78178C2.10204 4.57542 2.07461 4.22999 2.26394 3.99003C2.75642 3.36464 3.31618 2.79972 3.92735 2.31013C4.16668 2.11807 4.51782 2.14479 4.72535 2.37459C5.35121 3.06773 6.47542 3.32534 7.34413 2.96287C8.24815 2.58259 8.81822 1.66653 8.76244 0.683198C8.74407 0.37433 8.96981 0.10578 9.27774 0.0699156C10.0621 -0.0207993 10.8533 -0.0236121 11.6399 0.0636648C11.9443 0.0972629 12.1701 0.359484 12.1598 0.664446C12.1256 1.63809 12.7026 2.53813 13.5976 2.90474C14.4559 3.25533 15.5722 2.99991 16.1968 2.31294C16.4033 2.08666 16.7487 2.05885 16.9892 2.24629C17.6185 2.74003 18.1908 3.30541 18.6879 3.92565C18.8817 4.16678 18.8532 4.51627 18.6252 4.72372C17.8944 5.38553 17.6584 6.43832 18.0381 7.34359C18.4006 8.20668 19.2968 8.76292 20.3228 8.76292C20.6557 8.75222 20.8928 8.97568 20.9293 9.27838C21.0216 10.0672 21.0227 10.871 20.9338 11.6663C20.9008 11.9627 20.5462 12.1826 20.2453 12.1826C19.3309 12.1592 18.4531 12.7253 18.0848 13.6214C17.7177 14.5164 17.9537 15.5595 18.6719 16.2179C18.8966 16.4242 18.9251 16.7691 18.7358 17.0091C18.2479 17.6305 17.688 18.1959 17.0747 18.6896C16.8341 18.8835 16.4841 18.8561 16.2755 18.6263C15.6473 17.9315 14.5232 17.6743 13.6579 18.0375C12.7516 18.4166 12.1816 19.3326 12.2373 20.3165C12.2555 20.6255 12.0287 20.8945 11.722 20.9298C11.3208 20.9766 10.9172 21 10.5124 21C10.1282 21 9.74397 20.9789 9.35978 20.9361C9.05529 20.9025 8.82971 20.6403 8.83995 20.3348C8.87519 19.3617 8.29722 18.4617 7.40335 18.0957C6.53926 17.7428 5.42763 18.0011 4.80294 18.6873C4.59533 18.9131 4.25232 18.9404 4.01049 18.7536C3.38236 18.261 2.81119 17.6961 2.31183 17.0742C2.11806 16.8336 2.1454 16.4835 2.37457 16.2762C3.10537 15.6144 3.34251 14.5614 2.96285 13.6568C2.60593 12.8052 1.74301 12.2334 0.814838 12.2334L0.684978 12.2367C0.383924 12.2612 0.106936 12.0293 0.0704479 11.722C-0.0220642 10.9324 -0.0231609 10.1293 0.0657578 9.33409ZM10.4831 14.0245C12.4145 14.0245 13.9855 12.4536 13.9855 10.5222C13.9855 8.59094 12.4145 7.01988 10.4831 7.01988C8.55186 7.01988 6.98088 8.59094 6.98088 10.5222C6.98088 12.4536 8.55186 14.0245 10.4831 14.0245Z"
              ]
            }
          }
        ]
      },
      elements: {}
    };
  },
  mounted() {
    history.pushState({ id: "menu" }, "", "#menu");
    window.onpopstate = event => {
      let target = event.target.location.hash;
      document.querySelector(target).firstChild.focus();
    };
    window.addEventListener("message", this.focusItem);
  },
  methods: {
    focusItem: event => {
      // console.log(event);
      console.log(event.data);
      let mainMenu = document.querySelector("#menu");
      let next = document.activeElement.nextSibling;
      let prev = document.activeElement.previousSibling;
      let nextMenu = document.activeElement.hash;
      console.log(nextMenu);

      switch (event.data.action) {
        case "openMenu":
          mainMenu.classList.toggle("is-active");
          mainMenu.children[0].focus();
          break;
        case "closeMenu":
          mainMenu.classList.remove("is-active");
          break;
        case "controlPressed":
          switch (event.data.control) {
            case "RIGHT":
              if (next) {
                next.focus();
              }
              break;
            case "LEFT":
              if (prev) {
                prev.focus();
              }
              break;
            case "ENTER":
              document.querySelector(nextMenu).firstChild.focus();
              history.pushState({ id: "menu" }, "", nextMenu);
              break;
            case "BACKSPACE":
              window.history.back();
              if (document.activeElement.parentElement == mainMenu) {
                mainMenu.classList.remove("is-active");
              }
              break;
          }
      }

      document.activeElement.parentElement.childNodes.forEach(item => {
        item.classList.remove("is-active");
      });

      document.activeElement.classList.add("is-active");
    }
  }
};
</script>

<style lang="scss">
@import "menu.scss";
</style>
